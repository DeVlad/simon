/*! simon 2018-01-14 */

function Simon(t){this.skillLevel=8|t,this.lastLevel=0,this.sequence=[],this.longest=[],this.moveCount=0,this.strict=!1,this.completeLevel=!1,this.initEvents(settings.buttons)}var settings={buttons:{green:"btn-1",red:"btn-2",blue:"btn-3",yellow:"btn-4",skillLevel1:"skill1",skillLevel2:"skill2",skillLevel3:"skill3",skillLevel4:"skill4",start:"btn-start",last:"btn-last",longest:"btn-longest",strict:"btn-strict",strictIcon:"icon-strict",strictIndicatorOn:"red",strictIndicatorOff:"green"}};Simon.prototype.generateRandomPosition=function(t){var e=0;if(t>=0&&t<=4)do{e=Math.floor(4*Math.random())+1}while(t==e);return e},Simon.prototype.generateLevel=function(){if(this.lastLevel<=this.skillLevel){for(var t=[],e=0,i=0;i<this.lastLevel;i++)t.push(this.generateRandomPosition(e)),e=t[i];return this.sequence=t,t}console.log("Error")},Simon.prototype.initEvents=function(t){document.getElementById(t.skillLevel1).addEventListener("click",this.changeSkillLevel.bind(this,8)),document.getElementById(t.skillLevel2).addEventListener("click",this.changeSkillLevel.bind(this,14)),document.getElementById(t.skillLevel3).addEventListener("click",this.changeSkillLevel.bind(this,20)),document.getElementById(t.skillLevel4).addEventListener("click",this.changeSkillLevel.bind(this,31)),document.getElementById(t.last).addEventListener("click",this.displaySequence.bind(this)),document.getElementById(t.start).addEventListener("click",this.start.bind(this)),document.getElementById(t.longest).addEventListener("click",this.displaySequence.bind(this,"longest")),document.getElementById(t.strict).addEventListener("click",this.strictMode.bind(this,t.strictIcon)),document.getElementById(t.green).addEventListener("click",this.move.bind(this,t.green,1)),document.getElementById(t.red).addEventListener("click",this.move.bind(this,t.red,2)),document.getElementById(t.blue).addEventListener("click",this.move.bind(this,t.blue,3)),document.getElementById(t.yellow).addEventListener("click",this.move.bind(this,t.yellow,4))},Simon.prototype.start=function(){this.sequence=[],this.lastLevel=1,this.generateLevel(),this.displayLevel(),this.displaySequence()},Simon.prototype.move=function(t,e){if(this.illuminateButton(t,0),e===this.sequence[this.moveCount])this.moveCount++,this.moveCount===this.sequence.length&&(this.completeLevel=!0,this.longest.length<=this.sequence.length&&(this.longest=this.sequence));else{var i=this;this.strict?(this.completeLevel=!1,this.moveCount=0,setTimeout(function(){i.start()},3e3),this.displayMessage("Wrong")):(this.moveCount=0,this.completeLevel=!1,setTimeout(function(){i.displayLevel(),i.displaySequence()},3e3),this.displayMessage("Wrong"))}if(!0===this.completeLevel){this.lastLevel++,this.generateLevel();var n=this;setTimeout(function(){n.displayLevel(),n.displaySequence()},3e3),this.completeLevel=!1,this.moveCount=0,this.lastLevel>this.skillLevel&&this.stop()}},Simon.prototype.changeSkillLevel=function(t){this.skillLevel=t;var e=this;setTimeout(function(){e.start()},3e3),e.displayMessage("Restarting")},Simon.prototype.illuminateButton=function(t,e){var i=0;0===e?(e=400,i=600):i=e+1e3;var n=this;setTimeout(function(){document.getElementById(t).classList.add("lighten"),n.playSound(t)},e),setTimeout(function(){document.getElementById(t).classList.remove("lighten")},i)},Simon.prototype.displaySequence=function(t){var e=[];e="longest"==t?this.longest:this.sequence;for(var i=0,n=0;n<e.length;n++){var s="btn-"+e[n];i+=1e3,this.illuminateButton(s,i)}},Simon.prototype.displayLevel=function(){var t=this.lastLevel;document.getElementById("display").innerHTML=t},Simon.prototype.displayMessage=function(t){document.getElementById("display").innerHTML=t},Simon.prototype.playSound=function(t){var e="sound-"+t;document.getElementById(e).play()},Simon.prototype.strictMode=function(t){this.strict?(this.strict=!1,document.getElementById(t).classList.remove(settings.buttons.strictIndicatorOn),document.getElementById(t).classList.add(settings.buttons.strictIndicatorOff)):(this.strict=!0,document.getElementById(t).classList.remove(settings.buttons.strictIndicatorOff),document.getElementById(t).classList.add(settings.buttons.strictIndicatorOn))},Simon.prototype.stop=function(){var t=this;setTimeout(function(){t.displayMessage("You Win !")},3e3),this.lastLevel=0,this.sequence=[]};var game=new Simon;