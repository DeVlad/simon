/*! simon 2018-01-09 */

function Simon(e){this.skillLevel=8|e,this.lastLevel=0,this.sequence=[],this.longest=[],this.moveCount=0,this.strict=!1,this.completeLevel=!1,this.initEvents(settings.buttons)}var settings={buttons:{green:"btn-1",red:"btn-2",blue:"btn-3",yellow:"btn-4",skillLevel1:"skill1",skillLevel2:"skill2",skillLevel3:"skill3",skillLevel4:"skill4",start:"btn-start",last:"btn-last",longest:"btn-longest",strict:"btn-strict",strictIcon:"icon-strict"}};Simon.prototype.generateRandomPosition=function(e){var t=0;if(e>=0&&e<=4)do{t=Math.floor(4*Math.random())+1}while(e==t);return t},Simon.prototype.generateLevel=function(){if(this.lastLevel<=this.skillLevel){for(var e=[],t=0,n=0;n<this.lastLevel;n++)e.push(this.generateRandomPosition(t)),t=e[n];return this.sequence=e,e}return"Game Over"},Simon.prototype.initEvents=function(e){document.getElementById(e.skillLevel1).addEventListener("click",this.changeSkillLevel.bind(this,8)),document.getElementById(e.skillLevel2).addEventListener("click",this.changeSkillLevel.bind(this,14)),document.getElementById(e.skillLevel3).addEventListener("click",this.changeSkillLevel.bind(this,20)),document.getElementById(e.skillLevel4).addEventListener("click",this.changeSkillLevel.bind(this,31)),document.getElementById(e.last).addEventListener("click",this.displayLastSequence.bind(this)),document.getElementById(e.start).addEventListener("click",this.start.bind(this)),document.getElementById(e.longest).addEventListener("click",function(){console.log("LONGEST pressed")}),document.getElementById(e.strict).addEventListener("click",this.strictMode.bind(this,e.strict,e.strictIcon)),document.getElementById(e.green).addEventListener("click",this.move.bind(this,e.green,1)),document.getElementById(e.red).addEventListener("click",this.move.bind(this,e.red,2)),document.getElementById(e.blue).addEventListener("click",this.move.bind(this,e.blue,3)),document.getElementById(e.yellow).addEventListener("click",this.move.bind(this,e.yellow,4))},Simon.prototype.start=function(){this.sequence=[],this.lastLevel=1,this.generateLevel(),this.displayLevel(),this.displayLastSequence(),console.log("Start")},Simon.prototype.move=function(e,t){if(this.illuminateButton(e,0),console.log("Button:",t,"Level:",this.lastLevel,"Skill level:",this.skillLevel,"Sequence:",this.sequence),console.log("OUT Move count:",this.moveCount,"Seq length:",this.sequence.length),console.log("Button Number:",t,"sequence array item:",this.sequence[this.moveCount]),t===this.sequence[this.moveCount])console.log("Correct"),this.moveCount++,console.log("IN Move count:",this.moveCount,"Seq length:",this.sequence.length),this.moveCount===this.sequence.length&&(this.completeLevel=!0,console.log("Complete level !!!",this.completeLevel));else if(console.log("Wrong"),this.strict)console.log("Strict Mode, Restart game"),this.moveCount=0,this.completeLevel=!1,this.start();else{this.moveCount=0,this.completeLevel=!1;var n=this;setTimeout(function(){n.displayLevel(),n.displayLastSequence()},3e3),this.displayMessage("Wrong")}if(console.log("Move count:",this.moveCount),!0===this.completeLevel){console.log("Level Complete"),this.lastLevel++,this.generateLevel();var s=this;setTimeout(function(){s.displayLevel(),s.displayLastSequence()},3e3),this.completeLevel=!1,this.moveCount=0,this.lastLevel>this.skillLevel&&(console.log("Game Completed !"),this.stop())}},Simon.prototype.changeSkillLevel=function(e){console.log("Level: ",this.skillLevel),this.skillLevel=e,this.start()},Simon.prototype.illuminateButton=function(e,t){var n=0;0===t?(t=400,n=600):n=t+1e3;var s=this;setTimeout(function(){document.getElementById(e).classList.add("lighten"),s.playSound(e)},t),setTimeout(function(){document.getElementById(e).classList.remove("lighten")},n)},Simon.prototype.displayLastSequence=function(){console.log("Last Sequence",this.sequence);for(var e=0,t=0;t<this.sequence.length;t++){var n="btn-"+this.sequence[t];e+=1e3,this.illuminateButton(n,e)}},Simon.prototype.displayLevel=function(){var e=this.lastLevel;document.getElementById("display").innerHTML=e},Simon.prototype.displayMessage=function(e){document.getElementById("display").innerHTML=e},Simon.prototype.playSound=function(e){var t="sound-"+e;document.getElementById(t).play()},Simon.prototype.strictMode=function(e,t){var n="Unknown";this.strict?(this.strict=!1,n="NO",document.getElementById(t).classList.remove("red"),document.getElementById(t).classList.add("green")):(this.strict=!0,n="YES",document.getElementById(t).classList.remove("green"),document.getElementById(t).classList.add("red")),console.log("Strict mode: ",n)},Simon.prototype.stop=function(){var e=this;setTimeout(function(){e.displayMessage("You Win !")},3e3),this.lastLevel=0,this.sequence=[]};var game=new Simon;